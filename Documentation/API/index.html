<!DOCTYPE html>
<html lang="en">
  <head>
    <title>BlueSteel  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
  </head>
  <body>
    <a title="BlueSteel  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="index.html">BlueSteel Docs</a> (15% documented)</p>
        <p class="header-right"><a href="https://github.com/gilt/BlueSteel"><img src="img/gh.png"/>View on GitHub</a></p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html">BlueSteel Reference</a>
        <img id="carat" src="img/carat.png" />
        BlueSteel  Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/AvroDecoder.html">AvroDecoder</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/AvroEncoder.html">AvroEncoder</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Box.html">Box</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Enums.html">Enums</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Enums/AvroType.html">AvroType</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/AvroValue.html">AvroValue</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/Schema.html">Schema</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Extensions.html">Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Extensions/Bool.html">Bool</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/Double.html">Double</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/Float.html">Float</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/Int.html">Int</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/Int32.html">Int32</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/Int64.html">Int64</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/String.html">String</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/UInt64.html">UInt64</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Functions.html">Functions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Functions.html#/s:F9BlueSteeloi2peu0_Rxs8HashablerFTRGVs10Dictionaryxq__GS1_xq___T_">+=(_:_:)</a>
              </li>
              <li class="nav-group-task">
                <a href="Functions.html#/s:F9BlueSteeloi2eeFTOS_6SchemaS0__Sb">==(_:_:)</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/AvroValueConvertible.html">AvroValueConvertible</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Structs.html">Structs</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Structs/Varint.html">Varint</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            
            <p><img src="https://raw.githubusercontent.com/gilt/Cleanroom/master/Assets/hbc-digital-logo.png" alt="HBC Digital logo">     
<img src="https://raw.githubusercontent.com/gilt/Cleanroom/master/Assets/gilt-tech-logo.png" alt="Gilt Tech logo"></p>
<a href='#bluesteel' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h1 id='bluesteel'>BlueSteel</h1>

<p>An Avro encoding/decoding library for Swift.</p>

<p>BlueSteel is part of <a href="https://github.com/gilt/Cleanroom">the Cleanroom Project</a> from <a href="http://tech.gilt.com">Gilt Tech</a>.</p>
<a href='#swift-compatibility' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='swift-compatibility'>Swift compatibility</h3>

<p>This is the <code>master</code> branch. It uses <strong>Swift 3.1</strong> and <strong>requires Xcode 8.3</strong> to compile.</p>
<a href='#current-status' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h4 id='current-status'>Current status</h4>

<table><thead>
<tr>
<th>Branch</th>
<th>Build status</th>
</tr>
</thead><tbody>
<tr>
<td><a href="https://github.com/gilt/BlueSteel"><code>master</code></a></td>
<td><a href="https://travis-ci.org/gilt/BlueSteel"><img src="https://travis-ci.org/gilt/BlueSteel.svg?branch=master" alt="Build status: master branch"></a></td>
</tr>
</tbody></table>
<a href='#never-heard-of-avro' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='never-heard-of-avro'>Never heard of Avro?</h3>

<p>Take a gander at the <a href="http://avro.apache.org/docs/current/">official documentation for Avro</a> before reading further.</p>
<a href='#license' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='license'>License</h3>

<p>BlueSteel is distributed under <a href="https://github.com/gilt/BlueSteel/blob/master/LICENSE">the MIT license</a>.</p>

<p>BlueSteel is provided for your use—free-of-charge—on an as-is basis. We make no guarantees, promises or apologies. <em>Caveat developer.</em></p>
<a href='#adding-bluesteel-to-your-project' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='adding-bluesteel-to-your-project'>Adding BlueSteel to your project</h3>

<p><a href="https://github.com/Carthage/Carthage"><img src="https://img.shields.io/badge/Carthage-compatible-4BC51D.svg?style=flat" alt="Carthage compatible"></a></p>

<p>The simplest way to integrate BlueSteel is with the <a href="https://github.com/Carthage/Carthage">Carthage</a> dependency manager.</p>

<p>First, add this line to your <a href="https://github.com/Carthage/Carthage/blob/master/Documentation/Artifacts.md#cartfile"><code>Cartfile</code></a>:</p>
<pre class="highlight plaintext"><code>github "gilt/BlueSteel" ~&gt; 1.3.0
</code></pre>

<p>Then, use the <code>carthage</code> command to <a href="https://github.com/Carthage/Carthage#upgrading-frameworks">update your dependencies</a>.</p>

<p>Finally, you’ll need to <a href="https://github.com/gilt/BlueSteel/blob/master/INTEGRATION.md">integrate BlueSteel into your project</a> in order to use <a href="https://rawgit.com/gilt/BlueSteel/master/Documentation/API/index.html">the API</a> it provides.</p>

<p>Once successfully integrated, just add the following <code>import</code> statement to any Swift file where you want to use BlueSteel:</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">BlueSteel</span>
</code></pre>

<p>See <a href="https://github.com/gilt/BlueSteel/blob/master/INTEGRATION.md">the Integration document</a> for additional details on integrating BlueSteel into your project.</p>
<a href='#api-documentation' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='api-documentation'>API documentation</h3>

<p>For detailed information on using BlueSteel, <a href="https://rawgit.com/gilt/BlueSteel/master/Documentation/API/index.html">API documentation</a> is available.</p>
<a href='#usage' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='usage'>Usage</h2>

<p>Since Avro data is not self describing, we&rsquo;re going to need to supply an Avro Schema before we can (de)serialize any data. Schema enums are constructed from a JSON schema description, in either String or NSData form.</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">BlueSteel</span>

<span class="k">let</span> <span class="nv">jsonSchema</span> <span class="o">=</span> <span class="s">"{ </span><span class="se">\"</span><span class="s">type</span><span class="se">\"</span><span class="s"> : </span><span class="se">\"</span><span class="s">string</span><span class="se">\"</span><span class="s"> }"</span>
<span class="k">let</span> <span class="nv">schema</span> <span class="o">=</span> <span class="kt">Schema</span><span class="p">(</span><span class="n">jsonSchema</span><span class="p">)</span>
</code></pre>
<a href='#deserializing-avro-data' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='deserializing-avro-data'>Deserializing Avro data</h3>

<p>Using the Schema above, we can now decode some Avro binary data.</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">rawBytes</span><span class="p">:</span> <span class="p">[</span><span class="kt">Byte</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x6</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0x6f</span><span class="p">,</span> <span class="mh">0x6f</span><span class="p">]</span>
<span class="k">let</span> <span class="nv">avro</span> <span class="o">=</span> <span class="kt">AvroValue</span><span class="p">(</span><span class="nv">schema</span><span class="p">:</span> <span class="n">schema</span><span class="p">,</span> <span class="nv">withBytes</span><span class="p">:</span> <span class="n">rawBytes</span><span class="p">)</span>
</code></pre>

<p>We can now get the Swift String from the Avro value above using an optional getter.
<code>swift
if let avroString = avro.string {
    print(avroString) // Prints &quot;foo&quot;
}
</code></p>
<a href='#serializing-swift-data' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='serializing-swift-data'>Serializing Swift data</h3>

<p>We can use the same Schema above to serialize an AvroValue to binary.</p>
<pre class="highlight swift"><code><span class="k">if</span> <span class="k">let</span> <span class="nv">serialized</span> <span class="o">=</span> <span class="n">avro</span><span class="o">.</span><span class="nf">encode</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">serialized</span><span class="p">)</span> <span class="c1">// Prints [6, 102, 111, 111]</span>
<span class="p">}</span>
</code></pre>
<a href='#but-how-do-we-convert-our-own-swift-types-to-avrovalue' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h4 id='but-how-do-we-convert-our-own-swift-types-to-avrovalue'>But how do we convert our own Swift types to AvroValue?</h4>

<p>By conforming to the AvroValueConvertible protocol! You just need to extend your types with one function:
<code>swift
func toAvro() -&gt; AvroValue
</code></p>

<p>Suppose we wanted to serialize a NSUUID with the following schema:</p>
<pre class="highlight plaintext"><code>{
    "type" : "fixed",
    "name" : "UUID",
    "size" : 16
}
</code></pre>

<p>We could extend NSUUID as follows:</p>
<pre class="highlight swift"><code><span class="kd">extension</span> <span class="kt">NSUUID</span> <span class="p">:</span> <span class="kt">AvroValueConvertible</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">func</span> <span class="nf">toAvro</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">AvroValue</span> <span class="p">{</span>
        <span class="k">var</span> <span class="nv">uuidBytes</span><span class="p">:</span> <span class="p">[</span><span class="kt">Byte</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kt">Byte</span><span class="p">](</span><span class="nv">count</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span> <span class="nv">repeatedValue</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="nf">getUUIDBytes</span><span class="p">(</span><span class="o">&amp;</span><span class="n">uuidBytes</span><span class="p">)</span>
        <span class="k">return</span> <span class="kt">AvroValue</span><span class="o">.</span><span class="kt">AvroFixedValue</span><span class="p">(</span><span class="n">uuidBytes</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>To generate and serialize a NSUUID, we could now do:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">serialized</span><span class="p">:</span> <span class="p">[</span><span class="kt">Byte</span><span class="p">]?</span> <span class="o">=</span> <span class="kt">NSUUID</span><span class="p">()</span><span class="o">.</span><span class="nf">toAvro</span><span class="p">()</span><span class="o">.</span><span class="nf">encode</span><span class="p">(</span><span class="n">uuidSchema</span><span class="p">)</span>
</code></pre>

<p>Hey presto! We now have a byte array representing an NSUUID serialized to Avro according to the fixed schema provided.
Okay, so the example above is maybe a little bit too simple. Let&rsquo;s take a look at a more complex example. Suppose we have a record schema as follows:</p>
<pre class="highlight plaintext"><code>{
    "type": "record", 
        "name": "test",
        "fields" : [
        {"name": "a", "type": "long"},
        {"name": "b", "type": "string"}
    ]
}
</code></pre>

<p>We could create a corresponding type Swift that might look something like this:
<code>swift
struct testStruct {
    var a: Int64 = 0
    var b: String = &quot;&quot;
}
</code></p>

<p>To convert testStruct to AvroValue, we could extend it like this:</p>
<pre class="highlight swift"><code><span class="kd">extension</span> <span class="nv">testStruct</span> <span class="p">:</span> <span class="kt">AvroValueConvertible</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">toAvro</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">AvroValue</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kt">AvroValue</span><span class="o">.</span><span class="kt">AvroRecordValue</span><span class="p">([</span>
                <span class="s">"a"</span> <span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="nf">toAvro</span><span class="p">(),</span>
                <span class="s">"b"</span> <span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="nf">toAvro</span><span class="p">()])</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>You might&rsquo;ve noticed above that we called .toAvro() on Int64 and String values. We didn&rsquo;t have to define these ourselves because BlueSteel provides AvroValueConvertible extensions for Swift primitives.</p>

<p>So that just about covers a very quick introduction to BlueSteel. Please note that BlueSteel is still very early in development and may change significantly.</p>
<a href='#about' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='about'>About</h2>

<p>The Cleanroom Project began as an experiment to re-imagine Gilt’s iOS codebase in a legacy-free, Swift-based incarnation.</p>

<p>Since then, we’ve expanded the Cleanroom Project to include multi-platform support. Much of our codebase now supports tvOS in addition to iOS, and our lower-level code is usable on macOS and watchOS as well.</p>

<p>Cleanroom Project code serves as the foundation of Gilt on TV, our tvOS app <a href="http://www.apple.com/apple-events/september-2015/">featured by Apple during the launch of the new Apple TV</a>. And as time goes on, we&rsquo;ll be replacing more and more of our existing Objective-C codebase with Cleanroom implementations.</p>

<p>In the meantime, we’ll be tracking the latest releases of Swift &amp; Xcode, and <a href="https://github.com/gilt/Cleanroom#open-source-by-default">open-sourcing major portions of our codebase</a> along the way.</p>
<a href='#contributing' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='contributing'>Contributing</h3>

<p>BlueSteel is in active development, and we welcome your contributions.</p>

<p>If you’d like to contribute to this or any other Cleanroom Project repo, please read <a href="https://github.com/gilt/Cleanroom#contributing-to-the-cleanroom-project">the contribution guidelines</a>.</p>
<a href='#acknowledgements' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='acknowledgements'>Acknowledgements</h3>

<p><a href="https://rawgit.com/gilt/BlueSteel/master/Documentation/API/index.html">API documentation for BlueSteel</a> is generated using <a href="http://realm.io">Realm</a>’s <a href="https://github.com/realm/jazzy/">jazzy</a> project, maintained by <a href="https://github.com/jpsim">JP Simard</a> and <a href="https://github.com/segiddins">Samuel E. Giddins</a>.</p>

          </section>
        </section>
        <section id="footer">
          <p>© 2014-2017 <a class="link" href="http://tech.gilt.com/" target="_blank" rel="external">Gilt Groupe</a></p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.7.4</a>, a <a class="link" href="http://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
